## Sp1 Smart Contract Verifier
#### The existing input comes from [Ethereum block 20335518](https://etherscan.io/block/20335518)
This contract verifies Raiko proofs generated by Sp1. To run the existing test:

```shell
$ cd ./provers/sp1/contracts
$ forge test
```
The contract and proof is generated by [./provers/sp1/driver/src/gen_verifier.rs](../driver/src/gen_verifier.rs), which does the following things:

- download smart contract artifacts of the `sp1-sdk` version in used (skip if exists)
- read [./provers/sp1/driver/.env](../driver/.env) for the following environment variables

    ```
    # 'mock' for generating mock proofs locally, 'local' for generating proofs locally, 'network' for generating proofs using the proving network.
    SP1_PROVER=network
    # If using the proving network, set to your whitelisted private key. For more information, see:
    # https://docs.succinct.xyz/prover-network/setup.html#key-setup
    SP1_PRIVATE_KEY=ea64bf9b14ce979481ab4614aa4d6e8f7e1f7219d48a70d71398ad48179db6a5
    RUSTFLAGS='-C target-cpu=native' 
    RUST_LOG=debug 
    ```
- generate proof given `GuestInput` in [input.json](../contracts/src/fixtures/input.json) either remotely or locally
- serealize the proof into [fixture.json](../contracts/src/fixtures/fixture.json) to be tested in `RaikoVerifier.sol`

### To verify  a different block
You can either start Raiko and run [prove-block.sh](../../../script/prove-block.sh) to get the block you want from certain network and then run the `gen-verifier` to prove. Finally, you can verify with smart contract test.
```shell
$ cargo run
$ ./script/prove-block.sh taiko_mainnet native 192317 192317 '
    "proof_type": "native",
    "native": {
        "json_guest_input": "./provers/sp1/contracts/src/fixtures/input-taiko-mainnet-192317.json"
    }
'
$ cargo run --bin gen-verfier -- input-taiko-mainnet-192317.json
$ cd ./provers/sp1/contracts
$ forge test
```
You can also run [./script/sp1-e2e.sh](/script/sp1-e2e.sh) which does the same thing:
```
$ ./script/sp1-e2e.sh taiko_mainnet 192317
```